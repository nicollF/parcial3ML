
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Primer punto: Modelo de Clasificación &#8212; Parcial 3 Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'punto1';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Physical Therapy Dataset: Regresión" href="segundopunto.html" />
    <link rel="prev" title="Entrega parcial #3" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/uninortelogo.jpeg" class="logo__image only-light" alt="Parcial 3 Machine Learning - Home"/>
    <script>document.write(`<img src="_static/uninortelogo.jpeg" class="logo__image only-dark" alt="Parcial 3 Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Entrega parcial #3
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Primer punto: Modelo de Clasificación</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="segundopunto.html"><strong>Physical Therapy Dataset: Regresión</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpunto1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/punto1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Primer punto: Modelo de Clasificación</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Primer punto: Modelo de Clasificación</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-datos"><strong>Descripción de los datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-observaciones"><strong>Número de observaciones</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#media-mediana-minimo-maximo-cuartiles-desviacion-estandar"><strong>Media, mediana, mínimo, máximo, cuartiles, desviación estandar</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes"><strong>Datos Faltantes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas"><strong>Gráficas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-y-multicolinealidad"><strong>Correlación y multicolinealidad</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-multicolinealidad"><strong>Reducción de multicolinealidad</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-filtrados"><strong>Datos filtrados</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adasyn"><strong>Adasyn</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn"><strong>KNN</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-bayesiana"><strong>Clasificación bayesiana</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica"><strong>Regresión Logística</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#l1"><strong>L1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#l2"><strong>L2</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest"><strong>Random Forest</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost"><strong>XGboost</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm"><strong>SVM</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-metricas"><strong>Tablas de Metricas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc"><strong>Curvas ROC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusión</strong></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="primer-punto-modelo-de-clasificacion">
<h1><strong>Primer punto: Modelo de Clasificación</strong><a class="headerlink" href="#primer-punto-modelo-de-clasificacion" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_log_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">explained_variance_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">pypalettes</span> <span class="kn">import</span> <span class="n">load_cmap</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">squarify</span>
<span class="kn">import</span> <span class="nn">statsmodels</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">crosstab</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">fill_diagonal</span><span class="p">,</span> <span class="n">triu</span><span class="p">,</span> <span class="n">ones</span><span class="p">,</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">ADASYN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">BernoulliNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">ADASYN</span>
<span class="kn">from</span> <span class="nn">imblearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">ImbPipeline</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<p>Para realizar el ejercicio de modelos de clasificación utilizaremos un dataset que contiene información sobre la satisfacción de clientes.</p>
<section id="descripcion-de-los-datos">
<h2><strong>Descripción de los datos</strong><a class="headerlink" href="#descripcion-de-los-datos" title="Link to this heading">#</a></h2>
<p>Desde los equipos de soporte hasta los directivos, la satisfacción del cliente es una medida clave del
éxito. Los clientes insatisfechos no permanecen con la empresa y, en la mayoría de los casos, no expresan
su insatisfacción antes de irse. Una entidad financiera requiere identificar clientes insatisfechos al inicio de
su relación con la entidad. Esto permitiría tomar medidas proactivas para mejorar la experiencia del cliente
antes de que sea demasiado tarde. Debido a la sensibilidad, las variables son anonimizadas para predecir si
un cliente está satisfecho o insatisfecho con su experiencia en la entidad financiera.</p>
<p>A continuación, comenzaremos con el desarrollo del ejercicio.</p>
<p>importamos la base de datos con el nombre train.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\Usuario\Pictures\TercerParcial_ML\train.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="numero-de-observaciones">
<h3><strong>Número de observaciones</strong><a class="headerlink" href="#numero-de-observaciones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(76020, 371)
</pre></div>
</div>
</div>
</div>
<p>El dataset de train cuenta con 76.020 de oservaciones, y con 371 columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_types</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">type_counts</span> <span class="o">=</span> <span class="n">column_types</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">type_counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int64      260
float64    111
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Luego de realizar el conteo del tipo de variables que contiene nuestro dataset podemos observar que contiene un total de 260 variables enteras y 111 variables tipo float.</p>
<p>A continuación, se obtuvo una vista previa de las primeras 10 observaciones del dataset <strong>train</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="media-mediana-minimo-maximo-cuartiles-desviacion-estandar">
<h3><strong>Media, mediana, mínimo, máximo, cuartiles, desviación estandar</strong><a class="headerlink" href="#media-mediana-minimo-maximo-cuartiles-desviacion-estandar" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>var3</th>
      <th>var15</th>
      <th>imp_ent_var16_ult1</th>
      <th>imp_op_var39_comer_ult1</th>
      <th>imp_op_var39_comer_ult3</th>
      <th>imp_op_var40_comer_ult1</th>
      <th>imp_op_var40_comer_ult3</th>
      <th>imp_op_var40_efect_ult1</th>
      <th>imp_op_var40_efect_ult3</th>
      <th>...</th>
      <th>saldo_medio_var33_hace2</th>
      <th>saldo_medio_var33_hace3</th>
      <th>saldo_medio_var33_ult1</th>
      <th>saldo_medio_var33_ult3</th>
      <th>saldo_medio_var44_hace2</th>
      <th>saldo_medio_var44_hace3</th>
      <th>saldo_medio_var44_ult1</th>
      <th>saldo_medio_var44_ult3</th>
      <th>var38</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>...</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>76020.000000</td>
      <td>7.602000e+04</td>
      <td>76020.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>75964.050723</td>
      <td>-1523.199277</td>
      <td>33.212865</td>
      <td>86.208265</td>
      <td>72.363067</td>
      <td>119.529632</td>
      <td>3.559130</td>
      <td>6.472698</td>
      <td>0.412946</td>
      <td>0.567352</td>
      <td>...</td>
      <td>7.935824</td>
      <td>1.365146</td>
      <td>12.215580</td>
      <td>8.784074</td>
      <td>31.505324</td>
      <td>1.858575</td>
      <td>76.026165</td>
      <td>56.614351</td>
      <td>1.172358e+05</td>
      <td>0.039569</td>
    </tr>
    <tr>
      <th>std</th>
      <td>43781.947379</td>
      <td>39033.462364</td>
      <td>12.956486</td>
      <td>1614.757313</td>
      <td>339.315831</td>
      <td>546.266294</td>
      <td>93.155749</td>
      <td>153.737066</td>
      <td>30.604864</td>
      <td>36.513513</td>
      <td>...</td>
      <td>455.887218</td>
      <td>113.959637</td>
      <td>783.207399</td>
      <td>538.439211</td>
      <td>2013.125393</td>
      <td>147.786584</td>
      <td>4040.337842</td>
      <td>2852.579397</td>
      <td>1.826646e+05</td>
      <td>0.194945</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>-999999.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.163750e+03</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>38104.750000</td>
      <td>2.000000</td>
      <td>23.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.787061e+04</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>76043.000000</td>
      <td>2.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.064092e+05</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>113748.750000</td>
      <td>2.000000</td>
      <td>40.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.187563e+05</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>151838.000000</td>
      <td>238.000000</td>
      <td>105.000000</td>
      <td>210000.000000</td>
      <td>12888.030000</td>
      <td>21024.810000</td>
      <td>8237.820000</td>
      <td>11073.570000</td>
      <td>6600.000000</td>
      <td>6600.000000</td>
      <td>...</td>
      <td>50003.880000</td>
      <td>20385.720000</td>
      <td>138831.630000</td>
      <td>91778.730000</td>
      <td>438329.220000</td>
      <td>24650.010000</td>
      <td>681462.900000</td>
      <td>397884.300000</td>
      <td>2.203474e+07</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 371 columns</p>
</div></div></div>
</div>
<p>En la tabla anterior proporciona el resumen estadístico. Podemos encontrar el total, la media, desviación estandar, mínimos, máximos, cuartiles, de las variables de nuestro dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 76020 entries, 0 to 76019
Columns: 371 entries, ID to TARGET
dtypes: float64(111), int64(260)
memory usage: 215.2 MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="datos-faltantes">
<h3><strong>Datos Faltantes</strong><a class="headerlink" href="#datos-faltantes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">any_missing_overall</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">any_missing_overall</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">porcentaje_faltantes</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">porcentaje_faltantes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID                         0.0
var3                       0.0
var15                      0.0
imp_ent_var16_ult1         0.0
imp_op_var39_comer_ult1    0.0
                          ... 
saldo_medio_var44_hace3    0.0
saldo_medio_var44_ult1     0.0
saldo_medio_var44_ult3     0.0
var38                      0.0
TARGET                     0.0
Length: 371, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Realizammos el respectivo análisis para conocer si el dataset contiene datos faltantes. Obtuvimos que el porcentaje de los missingvalues de las variables es de 0%, por lo tanto, se puede concluir que en nuestro dataset no contamos con datos faltantes.</p>
<p>Además, podemos confirmar esto de manera visual, con ayuda de un heatmap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Missing Data Heatmap&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6b8cabe8996a7f8926524d2a81caf8bd8dd065297d415d2d35be3629cc6d0746.png" src="_images/6b8cabe8996a7f8926524d2a81caf8bd8dd065297d415d2d35be3629cc6d0746.png" />
</div>
</div>
<p>Aquí observamos algunos nombre de las columnas de dataset <strong>train</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID
var3
var15
imp_ent_var16_ult1
imp_op_var39_comer_ult1
imp_op_var39_comer_ult3
imp_op_var40_comer_ult1
imp_op_var40_comer_ult3
imp_op_var40_efect_ult1
imp_op_var40_efect_ult3
imp_op_var40_ult1
imp_op_var41_comer_ult1
imp_op_var41_comer_ult3
imp_op_var41_efect_ult1
imp_op_var41_efect_ult3
imp_op_var41_ult1
imp_op_var39_efect_ult1
imp_op_var39_efect_ult3
imp_op_var39_ult1
imp_sal_var16_ult1
ind_var1_0
ind_var1
ind_var2_0
ind_var2
ind_var5_0
ind_var5
ind_var6_0
ind_var6
ind_var8_0
ind_var8
ind_var12_0
ind_var12
ind_var13_0
ind_var13_corto_0
ind_var13_corto
ind_var13_largo_0
ind_var13_largo
ind_var13_medio_0
ind_var13_medio
ind_var13
ind_var14_0
ind_var14
ind_var17_0
ind_var17
ind_var18_0
ind_var18
ind_var19
ind_var20_0
ind_var20
ind_var24_0
ind_var24
ind_var25_cte
ind_var26_0
ind_var26_cte
ind_var26
ind_var25_0
ind_var25
ind_var27_0
ind_var28_0
ind_var28
ind_var27
ind_var29_0
ind_var29
ind_var30_0
ind_var30
ind_var31_0
ind_var31
ind_var32_cte
ind_var32_0
ind_var32
ind_var33_0
ind_var33
ind_var34_0
ind_var34
ind_var37_cte
ind_var37_0
ind_var37
ind_var39_0
ind_var40_0
ind_var40
ind_var41_0
ind_var41
ind_var39
ind_var44_0
ind_var44
ind_var46_0
ind_var46
num_var1_0
num_var1
num_var4
num_var5_0
num_var5
num_var6_0
num_var6
num_var8_0
num_var8
num_var12_0
num_var12
num_var13_0
num_var13_corto_0
num_var13_corto
num_var13_largo_0
num_var13_largo
num_var13_medio_0
num_var13_medio
num_var13
num_var14_0
num_var14
num_var17_0
num_var17
num_var18_0
num_var18
num_var20_0
num_var20
num_var24_0
num_var24
num_var26_0
num_var26
num_var25_0
num_var25
num_op_var40_hace2
num_op_var40_hace3
num_op_var40_ult1
num_op_var40_ult3
num_op_var41_hace2
num_op_var41_hace3
num_op_var41_ult1
num_op_var41_ult3
num_op_var39_hace2
num_op_var39_hace3
num_op_var39_ult1
num_op_var39_ult3
num_var27_0
num_var28_0
num_var28
num_var27
num_var29_0
num_var29
num_var30_0
num_var30
num_var31_0
num_var31
num_var32_0
num_var32
num_var33_0
num_var33
num_var34_0
num_var34
num_var35
num_var37_med_ult2
num_var37_0
num_var37
num_var39_0
num_var40_0
num_var40
num_var41_0
num_var41
num_var39
num_var42_0
num_var42
num_var44_0
num_var44
num_var46_0
num_var46
saldo_var1
saldo_var5
saldo_var6
saldo_var8
saldo_var12
saldo_var13_corto
saldo_var13_largo
saldo_var13_medio
saldo_var13
saldo_var14
saldo_var17
saldo_var18
saldo_var20
saldo_var24
saldo_var26
saldo_var25
saldo_var28
saldo_var27
saldo_var29
saldo_var30
saldo_var31
saldo_var32
saldo_var33
saldo_var34
saldo_var37
saldo_var40
saldo_var41
saldo_var42
saldo_var44
saldo_var46
var36
delta_imp_amort_var18_1y3
delta_imp_amort_var34_1y3
delta_imp_aport_var13_1y3
delta_imp_aport_var17_1y3
delta_imp_aport_var33_1y3
delta_imp_compra_var44_1y3
delta_imp_reemb_var13_1y3
delta_imp_reemb_var17_1y3
delta_imp_reemb_var33_1y3
delta_imp_trasp_var17_in_1y3
delta_imp_trasp_var17_out_1y3
delta_imp_trasp_var33_in_1y3
delta_imp_trasp_var33_out_1y3
delta_imp_venta_var44_1y3
delta_num_aport_var13_1y3
delta_num_aport_var17_1y3
delta_num_aport_var33_1y3
delta_num_compra_var44_1y3
delta_num_reemb_var13_1y3
delta_num_reemb_var17_1y3
delta_num_reemb_var33_1y3
delta_num_trasp_var17_in_1y3
delta_num_trasp_var17_out_1y3
delta_num_trasp_var33_in_1y3
delta_num_trasp_var33_out_1y3
delta_num_venta_var44_1y3
imp_amort_var18_hace3
imp_amort_var18_ult1
imp_amort_var34_hace3
imp_amort_var34_ult1
imp_aport_var13_hace3
imp_aport_var13_ult1
imp_aport_var17_hace3
imp_aport_var17_ult1
imp_aport_var33_hace3
imp_aport_var33_ult1
imp_var7_emit_ult1
imp_var7_recib_ult1
imp_compra_var44_hace3
imp_compra_var44_ult1
imp_reemb_var13_hace3
imp_reemb_var13_ult1
imp_reemb_var17_hace3
imp_reemb_var17_ult1
imp_reemb_var33_hace3
imp_reemb_var33_ult1
imp_var43_emit_ult1
imp_trans_var37_ult1
imp_trasp_var17_in_hace3
imp_trasp_var17_in_ult1
imp_trasp_var17_out_hace3
imp_trasp_var17_out_ult1
imp_trasp_var33_in_hace3
imp_trasp_var33_in_ult1
imp_trasp_var33_out_hace3
imp_trasp_var33_out_ult1
imp_venta_var44_hace3
imp_venta_var44_ult1
ind_var7_emit_ult1
ind_var7_recib_ult1
ind_var10_ult1
ind_var10cte_ult1
ind_var9_cte_ult1
ind_var9_ult1
ind_var43_emit_ult1
ind_var43_recib_ult1
var21
num_var2_0_ult1
num_var2_ult1
num_aport_var13_hace3
num_aport_var13_ult1
num_aport_var17_hace3
num_aport_var17_ult1
num_aport_var33_hace3
num_aport_var33_ult1
num_var7_emit_ult1
num_var7_recib_ult1
num_compra_var44_hace3
num_compra_var44_ult1
num_ent_var16_ult1
num_var22_hace2
num_var22_hace3
num_var22_ult1
num_var22_ult3
num_med_var22_ult3
num_med_var45_ult3
num_meses_var5_ult3
num_meses_var8_ult3
num_meses_var12_ult3
num_meses_var13_corto_ult3
num_meses_var13_largo_ult3
num_meses_var13_medio_ult3
num_meses_var17_ult3
num_meses_var29_ult3
num_meses_var33_ult3
num_meses_var39_vig_ult3
num_meses_var44_ult3
num_op_var39_comer_ult1
num_op_var39_comer_ult3
num_op_var40_comer_ult1
num_op_var40_comer_ult3
num_op_var40_efect_ult1
num_op_var40_efect_ult3
num_op_var41_comer_ult1
num_op_var41_comer_ult3
num_op_var41_efect_ult1
num_op_var41_efect_ult3
num_op_var39_efect_ult1
num_op_var39_efect_ult3
num_reemb_var13_hace3
num_reemb_var13_ult1
num_reemb_var17_hace3
num_reemb_var17_ult1
num_reemb_var33_hace3
num_reemb_var33_ult1
num_sal_var16_ult1
num_var43_emit_ult1
num_var43_recib_ult1
num_trasp_var11_ult1
num_trasp_var17_in_hace3
num_trasp_var17_in_ult1
num_trasp_var17_out_hace3
num_trasp_var17_out_ult1
num_trasp_var33_in_hace3
num_trasp_var33_in_ult1
num_trasp_var33_out_hace3
num_trasp_var33_out_ult1
num_venta_var44_hace3
num_venta_var44_ult1
num_var45_hace2
num_var45_hace3
num_var45_ult1
num_var45_ult3
saldo_var2_ult1
saldo_medio_var5_hace2
saldo_medio_var5_hace3
saldo_medio_var5_ult1
saldo_medio_var5_ult3
saldo_medio_var8_hace2
saldo_medio_var8_hace3
saldo_medio_var8_ult1
saldo_medio_var8_ult3
saldo_medio_var12_hace2
saldo_medio_var12_hace3
saldo_medio_var12_ult1
saldo_medio_var12_ult3
saldo_medio_var13_corto_hace2
saldo_medio_var13_corto_hace3
saldo_medio_var13_corto_ult1
saldo_medio_var13_corto_ult3
saldo_medio_var13_largo_hace2
saldo_medio_var13_largo_hace3
saldo_medio_var13_largo_ult1
saldo_medio_var13_largo_ult3
saldo_medio_var13_medio_hace2
saldo_medio_var13_medio_hace3
saldo_medio_var13_medio_ult1
saldo_medio_var13_medio_ult3
saldo_medio_var17_hace2
saldo_medio_var17_hace3
saldo_medio_var17_ult1
saldo_medio_var17_ult3
saldo_medio_var29_hace2
saldo_medio_var29_hace3
saldo_medio_var29_ult1
saldo_medio_var29_ult3
saldo_medio_var33_hace2
saldo_medio_var33_hace3
saldo_medio_var33_ult1
saldo_medio_var33_ult3
saldo_medio_var44_hace2
saldo_medio_var44_hace3
saldo_medio_var44_ult1
saldo_medio_var44_ult3
var38
TARGET
</pre></div>
</div>
</div>
</div>
<p>Obtuvimos el número de algunas variables específicamente para conocer más a detalle que tipo de datos contienen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;var15&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cantidad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var15
23     20170
24      6232
25      4217
26      3270
27      2861
       ...  
97         3
104        2
98         1
105        1
101        1
Name: count, Length: 100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;var3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cantidad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>var3
 2         74165
 8           138
-999999      116
 9           110
 3           108
           ...  
 231           1
 188           1
 168           1
 135           1
 87            1
Name: count, Length: 208, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cantidad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TARGET
0    73012
1     3008
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Observamos que en nuestra variable respuesta hay desbalance en las clases, siendo la clase 0 la que tiene mayor número de observaciones. Por lo que más adelante, para la implementación de los modelos, será necesario utilizar alguna tecnica de balanceo de clases.</p>
</section>
</section>
<section id="graficas">
<h2><strong>Gráficas</strong><a class="headerlink" href="#graficas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;RdPu&#39;</span><span class="p">)</span>  <span class="c1"># Cambia &#39;TARGET&#39; por el nombre exacto de tu variable</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Diagrama de Barras de la Variable TARGET&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Observaciones&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80f9dae4c70af30dc64d1f5715188d825dba94a0a169bae13c06e7e3049058d5.png" src="_images/80f9dae4c70af30dc64d1f5715188d825dba94a0a169bae13c06e7e3049058d5.png" />
</div>
</div>
<p>Al analizar la distribución de la variable <strong>TARGET</strong>, que es la variable de interés, se observa una clara desproporción en las observaciones. La categoría 0 tiene un número significativamente mayor de registros, con un total de 73,012 observaciones, mientras que la categoría 1 está representada por solo 3,008 observaciones. Esta distribución sugiere un desequilibrio en las clases, lo que podría afectar los resultados de los modelos de clasificación. Es importante tener en cuenta este desbalance al seleccionar y ajustar los modelos para asegurar una correcta evaluación y predicción.</p>
<p>Para realizar este ejercicio, se tomaron 10 variables del dataset para observar como se comportan las variables y que tipo de información contienen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var15</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;var15&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">top_15</span> <span class="o">=</span> <span class="n">var15</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">top_15</span><span class="o">.</span><span class="n">values</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">cell</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">top_15</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">top_15</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;RdPu&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
<span class="c1"># Crear el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">squarify</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sizes</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="c1"># Configuración del gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de la variable var15&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/455c28285ece651066bc54a146a7a359e930edad846cf3f4ed2c977d021f13b3.png" src="_images/455c28285ece651066bc54a146a7a359e930edad846cf3f4ed2c977d021f13b3.png" />
</div>
</div>
<p>Para la variable <strong>var15</strong>, la gráfica anterior muestra qué observación presenta la tendencia más destacada. Podemos ver que la categoría 23 tiene un total de 20,170 observaciones, siendo así la categoría con el mayor número de registros en esta variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#C71585&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;var3&#39;</span><span class="p">,</span> <span class="s1">&#39;var15&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_ent_var16_ult1&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var39_comer_ult1&#39;</span><span class="p">,</span>
             <span class="s1">&#39;imp_op_var40_comer_ult3&#39;</span><span class="p">,</span> <span class="s1">&#39;imp_op_var40_efect_ult1&#39;</span><span class="p">,</span>
             <span class="s1">&#39;saldo_medio_var33_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;saldo_medio_var33_ult1&#39;</span><span class="p">,</span>
             <span class="s1">&#39;saldo_medio_var44_hace2&#39;</span><span class="p">,</span> <span class="s1">&#39;var38&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/123f717faf91966bb80789efb17c40a38bdaa21af7b8083633fa2aa7ea21bb85.png" src="_images/123f717faf91966bb80789efb17c40a38bdaa21af7b8083633fa2aa7ea21bb85.png" />
</div>
</div>
<p>En la gráfica anterior, se muestra una serie de visualizaciones que permite observar el tipo de distribución de las 10 variables seleccionadas para el análisis. Visualmente, ninguna de estas distribuciones parece ajustarse a una distribución normal. En particular, la distribución de la variable <strong>var15</strong> destaca por ser ligeramente diferente a las demás; sin embargo, sigue sin mostrar características propias de una distribución normal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#C71585&#39;</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0baa073c2aa56ea3f1facd2b586a13b62a60575a286063c1a735fded926fbbbb.png" src="_images/0baa073c2aa56ea3f1facd2b586a13b62a60575a286063c1a735fded926fbbbb.png" />
</div>
</div>
<p>Además, utilizamos diagramas de caja para identificar posibles valores atípicos en las variables. Observamos que todas las gráficas presentan datos atípicos y que las cajas tienen una distribución muy limitada, lo cual sugiere que estas variables no siguen una distribución normal, ya que la caja se concentra en un único valor. Sin embargo, como se ha mencionado en análisis anteriores, la variable <strong>var15</strong> es la única que presenta una caja más clara en el gráfico, permitiendo observar la mediana, los valores mínimos y máximos, así como los datos atípicos.</p>
<p>Cabe resaltar, que en este ejercicio no se contaba con el contexto de cada variable en particular, por lo tanto, no fue necesario realizar imputación de datos faltantes.</p>
<section id="correlacion-y-multicolinealidad">
<h3><strong>Correlación y multicolinealidad</strong><a class="headerlink" href="#correlacion-y-multicolinealidad" title="Link to this heading">#</a></h3>
<p>Realizamos la matriz de correlación para saber que variables estan correlacionadas y proceder con la respectiva reducción de dimensionalidad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">correlation_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>var3</th>
      <th>var15</th>
      <th>imp_ent_var16_ult1</th>
      <th>imp_op_var39_comer_ult1</th>
      <th>imp_op_var39_comer_ult3</th>
      <th>imp_op_var40_comer_ult1</th>
      <th>imp_op_var40_comer_ult3</th>
      <th>imp_op_var40_efect_ult1</th>
      <th>imp_op_var40_efect_ult3</th>
      <th>...</th>
      <th>saldo_medio_var33_hace2</th>
      <th>saldo_medio_var33_hace3</th>
      <th>saldo_medio_var33_ult1</th>
      <th>saldo_medio_var33_ult3</th>
      <th>saldo_medio_var44_hace2</th>
      <th>saldo_medio_var44_hace3</th>
      <th>saldo_medio_var44_ult1</th>
      <th>saldo_medio_var44_ult3</th>
      <th>var38</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>1.000000</td>
      <td>-0.001025</td>
      <td>-0.002135</td>
      <td>-0.003111</td>
      <td>-0.001436</td>
      <td>-0.004131</td>
      <td>-0.007277</td>
      <td>-0.006302</td>
      <td>-0.006700</td>
      <td>-0.006698</td>
      <td>...</td>
      <td>0.001986</td>
      <td>0.003771</td>
      <td>-0.001521</td>
      <td>-0.001216</td>
      <td>-0.003772</td>
      <td>-0.003674</td>
      <td>-0.000856</td>
      <td>0.000297</td>
      <td>-0.005687</td>
      <td>0.003148</td>
    </tr>
    <tr>
      <th>var3</th>
      <td>-0.001025</td>
      <td>1.000000</td>
      <td>-0.004452</td>
      <td>0.001868</td>
      <td>0.005989</td>
      <td>0.006817</td>
      <td>0.001518</td>
      <td>0.001690</td>
      <td>0.000530</td>
      <td>0.000611</td>
      <td>...</td>
      <td>0.000716</td>
      <td>0.000491</td>
      <td>0.000638</td>
      <td>0.000669</td>
      <td>0.000617</td>
      <td>0.000508</td>
      <td>0.000738</td>
      <td>0.000778</td>
      <td>0.000071</td>
      <td>0.004475</td>
    </tr>
    <tr>
      <th>var15</th>
      <td>-0.002135</td>
      <td>-0.004452</td>
      <td>1.000000</td>
      <td>0.043722</td>
      <td>0.094762</td>
      <td>0.101177</td>
      <td>0.042754</td>
      <td>0.048512</td>
      <td>0.008805</td>
      <td>0.009678</td>
      <td>...</td>
      <td>0.029358</td>
      <td>0.017264</td>
      <td>0.028504</td>
      <td>0.029176</td>
      <td>0.029180</td>
      <td>0.018884</td>
      <td>0.032833</td>
      <td>0.033597</td>
      <td>0.006497</td>
      <td>0.101322</td>
    </tr>
    <tr>
      <th>imp_ent_var16_ult1</th>
      <td>-0.003111</td>
      <td>0.001868</td>
      <td>0.043722</td>
      <td>1.000000</td>
      <td>0.041221</td>
      <td>0.034879</td>
      <td>0.009896</td>
      <td>0.009377</td>
      <td>0.000592</td>
      <td>0.002510</td>
      <td>...</td>
      <td>-0.000864</td>
      <td>-0.000632</td>
      <td>-0.000548</td>
      <td>-0.000540</td>
      <td>0.002655</td>
      <td>-0.000612</td>
      <td>0.005055</td>
      <td>0.006590</td>
      <td>0.000007</td>
      <td>-0.000017</td>
    </tr>
    <tr>
      <th>imp_op_var39_comer_ult1</th>
      <td>-0.001436</td>
      <td>0.005989</td>
      <td>0.094762</td>
      <td>0.041221</td>
      <td>1.000000</td>
      <td>0.886476</td>
      <td>0.342709</td>
      <td>0.295295</td>
      <td>0.032280</td>
      <td>0.054809</td>
      <td>...</td>
      <td>0.016422</td>
      <td>0.011719</td>
      <td>0.012570</td>
      <td>0.013703</td>
      <td>0.009445</td>
      <td>0.005532</td>
      <td>0.011665</td>
      <td>0.010802</td>
      <td>0.012546</td>
      <td>0.010353</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>saldo_medio_var44_hace3</th>
      <td>-0.003674</td>
      <td>0.000508</td>
      <td>0.018884</td>
      <td>-0.000612</td>
      <td>0.005532</td>
      <td>0.006359</td>
      <td>-0.000480</td>
      <td>-0.000529</td>
      <td>-0.000170</td>
      <td>-0.000195</td>
      <td>...</td>
      <td>-0.000219</td>
      <td>-0.000151</td>
      <td>-0.000196</td>
      <td>-0.000205</td>
      <td>0.332172</td>
      <td>1.000000</td>
      <td>0.229158</td>
      <td>0.213191</td>
      <td>0.003646</td>
      <td>-0.002553</td>
    </tr>
    <tr>
      <th>saldo_medio_var44_ult1</th>
      <td>-0.000856</td>
      <td>0.000738</td>
      <td>0.032833</td>
      <td>0.005055</td>
      <td>0.011665</td>
      <td>0.010660</td>
      <td>-0.000254</td>
      <td>-0.000510</td>
      <td>-0.000254</td>
      <td>-0.000292</td>
      <td>...</td>
      <td>0.000819</td>
      <td>-0.000225</td>
      <td>0.002493</td>
      <td>0.002205</td>
      <td>0.818300</td>
      <td>0.229158</td>
      <td>1.000000</td>
      <td>0.968167</td>
      <td>0.003258</td>
      <td>-0.003104</td>
    </tr>
    <tr>
      <th>saldo_medio_var44_ult3</th>
      <td>0.000297</td>
      <td>0.000778</td>
      <td>0.033597</td>
      <td>0.006590</td>
      <td>0.010802</td>
      <td>0.009822</td>
      <td>-0.000372</td>
      <td>-0.000601</td>
      <td>-0.000268</td>
      <td>-0.000308</td>
      <td>...</td>
      <td>0.000977</td>
      <td>-0.000238</td>
      <td>0.002905</td>
      <td>0.002574</td>
      <td>0.710593</td>
      <td>0.213191</td>
      <td>0.968167</td>
      <td>1.000000</td>
      <td>0.003037</td>
      <td>-0.003015</td>
    </tr>
    <tr>
      <th>var38</th>
      <td>-0.005687</td>
      <td>0.000071</td>
      <td>0.006497</td>
      <td>0.000007</td>
      <td>0.012546</td>
      <td>0.013271</td>
      <td>0.016628</td>
      <td>0.015584</td>
      <td>-0.000315</td>
      <td>0.000682</td>
      <td>...</td>
      <td>0.004448</td>
      <td>0.001605</td>
      <td>0.004255</td>
      <td>0.004290</td>
      <td>0.002889</td>
      <td>0.003646</td>
      <td>0.003258</td>
      <td>0.003037</td>
      <td>1.000000</td>
      <td>-0.019510</td>
    </tr>
    <tr>
      <th>TARGET</th>
      <td>0.003148</td>
      <td>0.004475</td>
      <td>0.101322</td>
      <td>-0.000017</td>
      <td>0.010353</td>
      <td>0.003517</td>
      <td>0.003119</td>
      <td>-0.000358</td>
      <td>0.019221</td>
      <td>0.019965</td>
      <td>...</td>
      <td>-0.003533</td>
      <td>-0.002431</td>
      <td>-0.003166</td>
      <td>-0.003311</td>
      <td>-0.003177</td>
      <td>-0.002553</td>
      <td>-0.003104</td>
      <td>-0.003015</td>
      <td>-0.019510</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>371 rows × 371 columns</p>
</div></div></div>
</div>
<p>Además, también realizamos un mapa de calor en donde podemos analizar de manera visual que variables tienen correlación alta. Es importante aclarar que en esta gráfica solo se visualizó una parte de las variables para mayor comodidad al momento del análisis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlacion</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">correlacion_total</span> <span class="o">=</span> <span class="n">correlacion</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">top_20_variables</span> <span class="o">=</span> <span class="n">correlacion_total</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">correlacion_top_20</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">top_20_variables</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Configurar el tamaño del gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlacion_top_20</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mapa de Calor de las 50 Variables Más Correlacionadas&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e1c7c1649e8c270112180b66cd852ee70aaceb1262f61392b751c65f9b198959.png" src="_images/e1c7c1649e8c270112180b66cd852ee70aaceb1262f61392b751c65f9b198959.png" />
</div>
</div>
<p>Es importante análizar estas correlaciones mediante las gráficas de regresión, ya que, nos permite observar si estás variables pueden o no estar correlacionas, aunque, esto solo se sabe cuando se realiza la matriz de correlación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top_10_variables</span> <span class="o">=</span> <span class="n">correlacion_total</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Crear el gráfico de pairplot con regresión y hue</span>
<span class="n">pairplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">top_10_variables</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s1">&#39;TARGET&#39;</span><span class="p">])],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;TARGET&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span><span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;line_kws&#39;</span><span class="p">:{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">},</span> <span class="s1">&#39;scatter_kws&#39;</span><span class="p">:{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}}</span> <span class="p">)</span>
<span class="n">pairplot</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Gráficos de Regresión entre las 10 Variables Más Correlacionadas&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/529503b053153d790940dce3ec3f86e1811f7d8a729b2b1eab0b09942d93ebe1.png" src="_images/529503b053153d790940dce3ec3f86e1811f7d8a729b2b1eab0b09942d93ebe1.png" />
</div>
</div>
</section>
<section id="reduccion-de-multicolinealidad">
<h3><strong>Reducción de multicolinealidad</strong><a class="headerlink" href="#reduccion-de-multicolinealidad" title="Link to this heading">#</a></h3>
<p>Como científicos de datos, hemos diseñado un enfoque para reducir la dimensionalidad mediante la eliminación de variables que presentan correlaciones <strong>superiores a 0.7</strong>, las cuales son identificadas en la matriz de correlación. De esta manera, nos aseguramos de que no haya variables que estén altamente relacionadas entre sí, lo que podría generar redundancia y afectar negativamente los resultados del análisis. Este proceso ayuda a mantener solo una variable representativa de cada grupo de variables correlacionadas, reduciendo la multicolinealidad y mejorando la eficiencia y la interpretabilidad del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">correlation_matrix</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>

<span class="c1"># Encontrar columnas a eliminar</span>
<span class="n">to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">mask</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_drop</span><span class="p">:</span>
        <span class="n">correlated_columns</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">correlated_columns</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">to_drop</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">correlated_columns</span><span class="p">[</span><span class="n">correlated_columns</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">cleaned_correlation_matrix</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">to_drop</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cleaned_correlation_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                               ID      var3     var15  imp_ent_var16_ult1  \
ID                       1.000000 -0.001025 -0.002135           -0.003111   
var3                    -0.001025  1.000000 -0.004452            0.001868   
var15                   -0.002135 -0.004452  1.000000            0.043722   
imp_ent_var16_ult1      -0.003111  0.001868  0.043722            1.000000   
imp_sal_var16_ult1      -0.006793  0.000460  0.013525           -0.000053   
...                           ...       ...       ...                 ...   
saldo_medio_var29_hace3  0.000137  0.000143 -0.002859           -0.000194   
saldo_medio_var33_hace3  0.003771  0.000491  0.017264           -0.000632   
saldo_medio_var44_hace3 -0.003674  0.000508  0.018884           -0.000612   
var38                   -0.005687  0.000071  0.006497            0.000007   
TARGET                   0.003148  0.004475  0.101322           -0.000017   

                         imp_sal_var16_ult1  ind_var2_0  ind_var2  ind_var19  \
ID                                -0.006793         NaN       NaN  -0.001234   
var3                               0.000460         NaN       NaN   0.002537   
var15                              0.013525         NaN       NaN   0.065198   
imp_ent_var16_ult1                -0.000053         NaN       NaN   0.010492   
imp_sal_var16_ult1                 1.000000         NaN       NaN   0.014378   
...                                     ...         ...       ...        ...   
saldo_medio_var29_hace3           -0.000043         NaN       NaN  -0.000235   
saldo_medio_var33_hace3           -0.000141         NaN       NaN   0.000215   
saldo_medio_var44_hace3           -0.000148         NaN       NaN   0.014047   
var38                              0.003382         NaN       NaN   0.001284   
TARGET                             0.000509         NaN       NaN  -0.007957   

                         ind_var27_0  ind_var28_0  ...  \
ID                               NaN          NaN  ...   
var3                             NaN          NaN  ...   
var15                            NaN          NaN  ...   
imp_ent_var16_ult1               NaN          NaN  ...   
imp_sal_var16_ult1               NaN          NaN  ...   
...                              ...          ...  ...   
saldo_medio_var29_hace3          NaN          NaN  ...   
saldo_medio_var33_hace3          NaN          NaN  ...   
saldo_medio_var44_hace3          NaN          NaN  ...   
var38                            NaN          NaN  ...   
TARGET                           NaN          NaN  ...   

                         saldo_medio_var12_hace3  \
ID                                     -0.006099   
var3                                    0.002590   
var15                                   0.109747   
imp_ent_var16_ult1                      0.002407   
imp_sal_var16_ult1                      0.002124   
...                                          ...   
saldo_medio_var29_hace3                -0.000239   
saldo_medio_var33_hace3                -0.000791   
saldo_medio_var44_hace3                -0.000795   
var38                                   0.006872   
TARGET                                 -0.011867   

                         saldo_medio_var13_corto_hace3  \
ID                                            0.000061   
var3                                          0.003027   
var15                                         0.106964   
imp_ent_var16_ult1                           -0.000781   
imp_sal_var16_ult1                            0.005572   
...                                                ...   
saldo_medio_var29_hace3                      -0.000281   
saldo_medio_var33_hace3                      -0.000928   
saldo_medio_var44_hace3                       0.002307   
var38                                         0.016834   
TARGET                                       -0.013977   

                         saldo_medio_var13_largo_hace3  \
ID                                            0.000935   
var3                                          0.001381   
var15                                         0.072549   
imp_ent_var16_ult1                           -0.001304   
imp_sal_var16_ult1                           -0.000406   
...                                                ...   
saldo_medio_var29_hace3                      -0.000125   
saldo_medio_var33_hace3                      -0.000413   
saldo_medio_var44_hace3                      -0.000434   
var38                                         0.005060   
TARGET                                       -0.007005   

                         saldo_medio_var13_medio_hace3  \
ID                                                 NaN   
var3                                               NaN   
var15                                              NaN   
imp_ent_var16_ult1                                 NaN   
imp_sal_var16_ult1                                 NaN   
...                                                ...   
saldo_medio_var29_hace3                            NaN   
saldo_medio_var33_hace3                            NaN   
saldo_medio_var44_hace3                            NaN   
var38                                              NaN   
TARGET                                             NaN   

                         saldo_medio_var29_hace2  saldo_medio_var29_hace3  \
ID                                      0.000693                 0.000137   
var3                                    0.000199                 0.000143   
var15                                   0.007891                -0.002859   
imp_ent_var16_ult1                     -0.000272                -0.000194   
imp_sal_var16_ult1                     -0.000060                -0.000043   
...                                          ...                      ...   
saldo_medio_var29_hace3                 0.005183                 1.000000   
saldo_medio_var33_hace3                -0.000061                -0.000043   
saldo_medio_var44_hace3                -0.000064                -0.000046   
var38                                  -0.000720                -0.001188   
TARGET                                 -0.001034                -0.000736   

                         saldo_medio_var33_hace3  saldo_medio_var44_hace3  \
ID                                      0.003771                -0.003674   
var3                                    0.000491                 0.000508   
var15                                   0.017264                 0.018884   
imp_ent_var16_ult1                     -0.000632                -0.000612   
imp_sal_var16_ult1                     -0.000141                -0.000148   
...                                          ...                      ...   
saldo_medio_var29_hace3                -0.000043                -0.000046   
saldo_medio_var33_hace3                 1.000000                -0.000151   
saldo_medio_var44_hace3                -0.000151                 1.000000   
var38                                   0.001605                 0.003646   
TARGET                                 -0.002431                -0.002553   

                            var38    TARGET  
ID                      -0.005687  0.003148  
var3                     0.000071  0.004475  
var15                    0.006497  0.101322  
imp_ent_var16_ult1       0.000007 -0.000017  
imp_sal_var16_ult1       0.003382  0.000509  
...                           ...       ...  
saldo_medio_var29_hace3 -0.001188 -0.000736  
saldo_medio_var33_hace3  0.001605 -0.002431  
saldo_medio_var44_hace3  0.003646 -0.002553  
var38                    1.000000 -0.019510  
TARGET                  -0.019510  1.000000  

[70 rows x 70 columns]
</pre></div>
</div>
</div>
</div>
<p>Realizamos nuevamente el mapa de calor, y podemos observar que las variables que antes aparecían con alta correlación ya no se encuentran en el dataset, y en esta gráfica solo se aprecian aquellas variables que no estan correlacionadas entre si o no tiene una correlación significativa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlacion_total</span> <span class="o">=</span> <span class="n">cleaned_correlation_matrix</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">top_20_variables</span> <span class="o">=</span> <span class="n">correlacion_total</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">top_20_correlation_matrix</span> <span class="o">=</span> <span class="n">cleaned_correlation_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">top_20_variables</span><span class="p">,</span> <span class="n">top_20_variables</span><span class="p">]</span>

<span class="c1"># Configurar el tamaño del gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># Crear el mapa de calor para las 20 variables más importantes</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">top_20_correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Configurar el título del gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mapa de Calor de las 20 Variables Más Correlacionadas&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9c021ee86fe74203290f7aec1a7411745ba7e4f017e1ccc2ff65da09a7345a2c.png" src="_images/9c021ee86fe74203290f7aec1a7411745ba7e4f017e1ccc2ff65da09a7345a2c.png" />
</div>
</div>
<p>Guardamos el resultado obtenido luego de la eliminación en un nuevo dataframe que nos ayudará más adelante con el entrenamiento de los modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables_remaining</span> <span class="o">=</span> <span class="n">cleaned_correlation_matrix</span><span class="o">.</span><span class="n">columns</span>
<span class="n">df_remaining_variables</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">variables_remaining</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Variables&#39;</span><span class="p">])</span>
<span class="n">filtered_train</span><span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">variables_remaining</span><span class="p">]</span>
<span class="n">filtered_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>var3</th>
      <th>var15</th>
      <th>imp_ent_var16_ult1</th>
      <th>imp_sal_var16_ult1</th>
      <th>ind_var2_0</th>
      <th>ind_var2</th>
      <th>ind_var19</th>
      <th>ind_var27_0</th>
      <th>ind_var28_0</th>
      <th>...</th>
      <th>saldo_medio_var12_hace3</th>
      <th>saldo_medio_var13_corto_hace3</th>
      <th>saldo_medio_var13_largo_hace3</th>
      <th>saldo_medio_var13_medio_hace3</th>
      <th>saldo_medio_var29_hace2</th>
      <th>saldo_medio_var29_hace3</th>
      <th>saldo_medio_var33_hace3</th>
      <th>saldo_medio_var44_hace3</th>
      <th>var38</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>39205.170000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
      <td>34</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>122.22</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>49278.030000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2</td>
      <td>23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>67333.770000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>2</td>
      <td>37</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>64007.970000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>2</td>
      <td>39</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>117310.979016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76015</th>
      <td>151829</td>
      <td>2</td>
      <td>48</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>60926.490000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76016</th>
      <td>151830</td>
      <td>2</td>
      <td>39</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>118634.520000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76017</th>
      <td>151835</td>
      <td>2</td>
      <td>23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>74028.150000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76018</th>
      <td>151836</td>
      <td>2</td>
      <td>25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>84278.160000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>76019</th>
      <td>151838</td>
      <td>2</td>
      <td>46</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>117310.979016</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>76020 rows × 70 columns</p>
</div></div></div>
</div>
<p>También se realizaron diagramas de dispersión, los cuales son fundamentales para confirmar visualmente que las variables no están correlacionadas entre sí. Estas gráficas permiten observar las relaciones entre cada par de variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_columns</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">df_selected</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">selected_columns</span><span class="p">]</span>
<span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span> 
<span class="n">pairplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_selected</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">])</span>
<span class="n">pairplot</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Gráficas de Dispersión de las 5 Variables Seleccionadas&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">pairplot</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a3da75668f77a2ac2846ae06ecc24a7451ad069585e33fa2d36048707b056437.png" src="_images/a3da75668f77a2ac2846ae06ecc24a7451ad069585e33fa2d36048707b056437.png" />
</div>
</div>
<p>Podemos observar que despues de la eliminación de multicolinealidad, las variables visualmente no presentan correlación entre si.</p>
</section>
</section>
<section id="datos-filtrados">
<h2><strong>Datos filtrados</strong><a class="headerlink" href="#datos-filtrados" title="Link to this heading">#</a></h2>
<p>Importamos nuestra base de datos luego de la reducción de variables altamente correlacionadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filtertrain</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\Usuario\Pictures\TercerParcial_ML\filtered_train.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filtertrain</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>var3</th>
      <th>var15</th>
      <th>imp_ent_var16_ult1</th>
      <th>imp_sal_var16_ult1</th>
      <th>ind_var2_0</th>
      <th>ind_var2</th>
      <th>ind_var19</th>
      <th>ind_var27_0</th>
      <th>ind_var28_0</th>
      <th>...</th>
      <th>saldo_medio_var12_hace3</th>
      <th>saldo_medio_var13_corto_hace3</th>
      <th>saldo_medio_var13_largo_hace3</th>
      <th>saldo_medio_var13_medio_hace3</th>
      <th>saldo_medio_var29_hace2</th>
      <th>saldo_medio_var29_hace3</th>
      <th>saldo_medio_var33_hace3</th>
      <th>saldo_medio_var44_hace3</th>
      <th>var38</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>39205.170000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
      <td>34</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>122.22</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>49278.030000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2</td>
      <td>23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>67333.770000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8</td>
      <td>2</td>
      <td>37</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>64007.970000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>2</td>
      <td>39</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>117310.979016</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos">
<h1><strong>Modelos</strong><a class="headerlink" href="#modelos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">filtertrain</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">filtertrain</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="adasyn">
<h2><strong>Adasyn</strong><a class="headerlink" href="#adasyn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adasyn</span> <span class="o">=</span> <span class="n">ADASYN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span> <span class="o">=</span> <span class="n">adasyn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">x_new_test</span><span class="p">,</span> <span class="n">y_new_test</span> <span class="o">=</span> <span class="n">adasyn</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_new_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_new_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((117906, 69), (117906,))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_new_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_new_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((29169, 69), (29169,))
</pre></div>
</div>
</div>
</div>
<p>Usaramos la métrica AUC, ya que, es ideal para evaluar este tipo de ejercicios que buscan distinguir entre la clase 0 y la clase 1, lo que garantiza que los modelos tengan un buen desempeño para este tipo de implementación.</p>
</section>
<section id="knn">
<h2><strong>KNN</strong><a class="headerlink" href="#knn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())])</span>
<span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
    <span class="s1">&#39;knn__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span>
    <span class="s1">&#39;knn__p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> 
<span class="p">}]</span>

<span class="n">k_fold_knn</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">grid_search_k</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_knn</span><span class="p">,</span> <span class="n">param_grid_knn</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold_knn</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_k</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="n">best_parameters_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">best_score_</span>

<span class="c1"># Predicciones en el conjunto de test</span>
<span class="n">model_pred_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">prob_knn</span> <span class="o">=</span> <span class="n">grid_search_k</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calcular la precisión en el conjunto de test</span>
<span class="n">auc_test_knn</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters_knn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score_knn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precisión en el conjunto de test: &#39;</span><span class="p">,</span> <span class="n">auc_test_knn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;knn__n_neighbors&#39;: 14, &#39;knn__p&#39;: 1, &#39;knn__weights&#39;: &#39;distance&#39;}
Mejor score de entrenamiento:  0.9698432965528724
Precisión en el conjunto de test:  0.8894245925920354
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_knn.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_k</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla1</span><span class="p">)</span>
<span class="n">tabla</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>0.852974</td>
      <td>0.778182</td>
      <td>0.813863</td>
      <td>0.889425</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="c1"># Calcular la matriz de confusión</span>
<span class="n">conf_matrix_knn</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_knn</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_knn</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5d63b3ca4eae1ee1679f43ec31948574aa4a6d621d0fcb8960e8c1760446fde.png" src="_images/f5d63b3ca4eae1ee1679f43ec31948574aa4a6d621d0fcb8960e8c1760446fde.png" />
</div>
</div>
<p>La matriz de confusión refleja un buen rendiemiento del modelo ya que se puede observar que identificó correctamente 13.067 clientes satisfechos y 12.712 clientes insatisfechos.</p>
</section>
<section id="clasificacion-bayesiana">
<h2><strong>Clasificación bayesiana</strong><a class="headerlink" href="#clasificacion-bayesiana" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_cb</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  <span class="c1"># Escalador</span>
    <span class="p">(</span><span class="s1">&#39;nb&#39;</span><span class="p">,</span> <span class="n">BernoulliNB</span><span class="p">())</span>          <span class="c1"># Clasificador</span>
<span class="p">])</span>

<span class="n">param_grid_cb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;nb__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>  <span class="c1"># Parámetro de suavizado para BernoulliNB</span>
<span class="p">}</span>

<span class="c1"># Configurar GridSearchCV</span>
<span class="n">grid_search_cb</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_cb</span><span class="p">,</span> <span class="n">param_grid_cb</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid_search_cb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="n">y_test_pred_cb</span> <span class="o">=</span> <span class="n">grid_search_cb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">best_params_cb</span> <span class="o">=</span> <span class="n">grid_search_cb</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score_cb</span> <span class="o">=</span> <span class="n">grid_search_cb</span><span class="o">.</span><span class="n">best_score_</span>
<span class="n">prob_cb</span> <span class="o">=</span> <span class="n">grid_search_cb</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">test_auc_roc_cb</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_cb</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros:&quot;</span><span class="p">,</span> <span class="n">best_params_cb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor puntaje en entrenamiento:&quot;</span><span class="p">,</span> <span class="n">best_score_cb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AUC-ROC en el conjunto de test:&quot;</span><span class="p">,</span> <span class="n">test_auc_roc_cb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 4 candidates, totalling 20 fits
Mejores parámetros: {&#39;nb__alpha&#39;: 100}
Mejor puntaje en entrenamiento: 0.784343249712661
AUC-ROC en el conjunto de test: 0.7638358676031951
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_cb.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_cb</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Clasificación bayesiana&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_test_pred_cb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_test_pred_cb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_test_pred_cb</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_cb</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_cb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tabla2</span><span class="p">)</span>
<span class="n">tabla_cb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Clasificación bayesiana</td>
      <td>0.688863</td>
      <td>0.726106</td>
      <td>0.706994</td>
      <td>0.763836</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_cb</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_test_pred_cb</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_cb</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/811900f3f8d884450c83e243cd414c56a897b6407487f2166f434fc7954ef690.png" src="_images/811900f3f8d884450c83e243cd414c56a897b6407487f2166f434fc7954ef690.png" />
</div>
</div>
<p>Al obsevar la gráfica anterior, podemos concluir que el modelo tiene un rendimiento aceptable, aunque vale resaltar que hay falsos negativos y falsos postivos que no está detectando. En general, detectó bien los clientes satisfechos e insatisfechos.</p>
</section>
<section id="regresion-logistica">
<h2><strong>Regresión Logística</strong><a class="headerlink" href="#regresion-logistica" title="Link to this heading">#</a></h2>
<section id="l1">
<h3><strong>L1</strong><a class="headerlink" href="#l1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_l1</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">param_grid_l1</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span> 
<span class="p">}]</span>

<span class="n">k_fold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_lr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_l1</span><span class="p">,</span> <span class="n">param_grid_l1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">best_score_</span>

<span class="n">model_pred_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">prob_lr</span> <span class="o">=</span> <span class="n">grid_search_lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;logreg__C&#39;: 100}
Mejor score de entrenamiento:  0.8144889576298491
Score en el conjunto de test:  0.7957372599139052
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_logreg_l1.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_lr</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tablal1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Regresión Logistica L1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_rl1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tablal1</span><span class="p">)</span>
<span class="n">tabla_rl1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Logistica L1</td>
      <td>0.753786</td>
      <td>0.765009</td>
      <td>0.759356</td>
      <td>0.795737</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_l1</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">model_pred_lr</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_l1</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d6f444b0cc45765df7e7cc1765d1815e0a22adf239c5d943edb475e13791fce7.png" src="_images/d6f444b0cc45765df7e7cc1765d1815e0a22adf239c5d943edb475e13791fce7.png" />
</div>
</div>
<p>Al igual que los anteriores modelos, el modelo de regresión logística con penalización L1 tiene una buena detección de los clientes satisfechos e insatisfechos. Sin embargo tambien tiene cierto margen de error.</p>
</section>
<section id="l2">
<h3><strong>L2</strong><a class="headerlink" href="#l2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Configurar el grid de parámetros para el modelo de regresión logística con L2</span>
<span class="n">param_grid_l2</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="s1">&#39;logistic__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">}]</span>

<span class="c1"># Configurar StratifiedKFold para validación cruzada</span>
<span class="n">cv_strategy</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Configurar GridSearchCV</span>
<span class="n">grid_search_model</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">model_pipeline</span><span class="p">,</span> <span class="n">param_grid_l2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv_strategy</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Ajustar el modelo</span>
<span class="n">grid_search_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="c1"># Obtener mejores parámetros y puntuación</span>
<span class="n">optimal_params</span> <span class="o">=</span> <span class="n">grid_search_model</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_auc_score</span> <span class="o">=</span> <span class="n">grid_search_model</span><span class="o">.</span><span class="n">best_score_</span>

<span class="c1"># Predicciones en el conjunto de prueba</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">grid_search_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="n">grid_search_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">optimal_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_auc_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test: &#39;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;logistic__C&#39;: 100}
Mejor score de entrenamiento:  0.8144863019039652
Score en el conjunto de test:  0.7957502965926692
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_logreg_l2.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_model</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tablal2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Regresión Logistica L2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_rl2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tablal2</span><span class="p">)</span>
<span class="n">tabla_rl2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Logistica L2</td>
      <td>0.753871</td>
      <td>0.76494</td>
      <td>0.759365</td>
      <td>0.79575</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_l2</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_l2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cc5b2ffd23a00e16fb7a95d8cc473da7bd0f9c05ac7f04f4751a4209701636d3.png" src="_images/cc5b2ffd23a00e16fb7a95d8cc473da7bd0f9c05ac7f04f4751a4209701636d3.png" />
</div>
</div>
<p>Al analizar la grafica anterior, podemos concluir que el modelo tiene un buen rendiemiento general con altas predicciones correctas.</p>
</section>
</section>
<section id="random-forest">
<h2><strong>Random Forest</strong><a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_rf</span> <span class="o">=</span> <span class="n">ImbPipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;forest&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<span class="p">])</span>


<span class="n">param_grid_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;forest__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
    <span class="s1">&#39;forest__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">cv_rf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="n">grid_search_rf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_rf</span><span class="p">,</span> <span class="n">param_grid_rf</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv_rf</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="n">best_params_rf</span> <span class="o">=</span> <span class="n">grid_search_rf</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">best_score_rf</span> <span class="o">=</span> <span class="n">grid_search_rf</span><span class="o">.</span><span class="n">best_score_</span>


<span class="n">predictions_rf</span> <span class="o">=</span> <span class="n">grid_search_rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">probabilities_rf</span> <span class="o">=</span> <span class="n">grid_search_rf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros: &quot;</span><span class="p">,</span> <span class="n">best_params_rf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento: &quot;</span><span class="p">,</span> <span class="n">best_score_rf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score en el conjunto de test (AUC): &#39;</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities_rf</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros:  {&#39;forest__max_depth&#39;: 40, &#39;forest__n_estimators&#39;: 200}
Mejor score de entrenamiento:  0.9863584108141612
Score en el conjunto de test (AUC):  0.9401914318509146
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_rf.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_rf</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tablarf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions_rf</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities_rf</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_modelrf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tablarf</span><span class="p">)</span>
<span class="n">tabla_modelrf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Random Forest</td>
      <td>0.914397</td>
      <td>0.787856</td>
      <td>0.846423</td>
      <td>0.940191</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_rf</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">predictions_rf</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_rf</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/058727c8958a30f16ef14cab52ecbbeee7b82d07e01b38dcd97727f5597b7304.png" src="_images/058727c8958a30f16ef14cab52ecbbeee7b82d07e01b38dcd97727f5597b7304.png" />
</div>
</div>
<p>El modelo Random Forest, también tiene alta capacidad de clasificación para ambas clases, con una proporción significativamente alta de acierto en comparación con los errores.</p>
</section>
<section id="xgboost">
<h2><strong>XGboost</strong><a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgb_pipeline</span> <span class="o">=</span> <span class="n">ImbPipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;xgb&#39;</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">use_label_encoder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;logloss&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">xgb_paramgrid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;xgb__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
    <span class="s1">&#39;xgb__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="s1">&#39;xgb__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">xgb_gridsearch</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">xgb_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">xgb_paramgrid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">skf</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xgb_gridsearch</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="n">best_model_xg</span> <span class="o">=</span> <span class="n">xgb_gridsearch</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">y_pred_xg</span> <span class="o">=</span> <span class="n">best_model_xg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de entrenamiento:&quot;</span><span class="p">,</span> <span class="n">xgb_gridsearch</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor parámetro:&quot;</span><span class="p">,</span> <span class="n">xgb_gridsearch</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">xgb_gridsearch</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">auc_xg</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor score de conjunto de prueba (AUC):&quot;</span><span class="p">,</span> <span class="n">auc_xg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 5 folds for each of 27 candidates, totalling 135 fits
Mejor score de entrenamiento: 0.9685540077743149
Mejor parámetro: {&#39;xgb__learning_rate&#39;: 0.1, &#39;xgb__max_depth&#39;: 7, &#39;xgb__n_estimators&#39;: 200}
Mejor score de conjunto de prueba (AUC): 0.9502465121712887
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_xg&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">xgb_gridsearch</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tablaxg</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_xg</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_xg</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_xg</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_boost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tablaxg</span><span class="p">)</span>
<span class="n">tabla_boost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>XGBoost</td>
      <td>0.892759</td>
      <td>0.872178</td>
      <td>0.882349</td>
      <td>0.950247</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_xg</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_xg</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_xg</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5d63b3ca4eae1ee1679f43ec31948574aa4a6d621d0fcb8960e8c1760446fde.png" src="_images/f5d63b3ca4eae1ee1679f43ec31948574aa4a6d621d0fcb8960e8c1760446fde.png" />
</div>
</div>
<p>El modelo tiene tiene alta cantidad en las predicciones correctas, y a comparación de los demás el margen de error es más pequeño. Por lo que se puede concluir que tiene un desempeño sobresaliente en la identificación de los clientes satisfechos e insatisfechos.</p>
</section>
<section id="svm">
<h2><strong>SVM</strong><a class="headerlink" href="#svm" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_svm</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>       
    <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">param_grid_svm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;svm__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>        
    <span class="s1">&#39;svm__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">],</span> 
    <span class="s1">&#39;svm__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">],</span>             
<span class="p">}</span>

<span class="n">stratified_kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">grid_search_svm</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_svm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid_svm</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">stratified_kfold</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">grid_search_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new_train</span><span class="p">,</span> <span class="n">y_new_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best parameters found: &quot;</span><span class="p">,</span> <span class="n">grid_search_svm</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">grid_search_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)</span>
<span class="n">y_prob_svm</span> <span class="o">=</span> <span class="n">grid_search_svm</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_new_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">scoretrainsvm</span> <span class="o">=</span> <span class="n">grid_search_svm</span><span class="o">.</span><span class="n">best_score_</span>
<span class="n">test_auc_roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_prob_svm</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;score conjunto de entremaniento:&quot;</span><span class="p">,</span> <span class="n">scoretrainsvm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AUC-ROC score on test set: </span><span class="si">{</span><span class="n">test_auc_roc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best parameters found:  {&#39;svm__C&#39;: 10, &#39;svm__gamma&#39;: &#39;scale&#39;, &#39;svm__kernel&#39;: &#39;rbf&#39;}
score conjunto de entremaniento: 0.9273269842020369
AUC-ROC score on test set: 0.9141997498443285
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mejor_modelo_svm&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">grid_search_svm</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tablalsvm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SVM&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">precision_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">recall_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">f1_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_prob_svm</span><span class="p">),</span>  
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">tabla_modelsvm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tablalsvm</span><span class="p">)</span>
<span class="n">tabla_modelsvm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SVM</td>
      <td>0.866342</td>
      <td>0.840961</td>
      <td>0.853462</td>
      <td>0.9142</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conf_matrix_svm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">)</span>

<span class="c1"># Visualizar la matriz de confusión con un heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conf_matrix_svm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Predicho 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicho 1&#39;</span><span class="p">],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Real 1&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase Predicha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Clase Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/518d69fe4dd516e00939fc6a369ee2f9287f7a279d5c88283c324ff3d865fd8e.png" src="_images/518d69fe4dd516e00939fc6a369ee2f9287f7a279d5c88283c324ff3d865fd8e.png" />
</div>
</div>
<p>La matriz de confusión para el modelo de SVM nos muestra que el modelo tiene un desempeño solido, ya que predijo correctamente para la clase 0 un total de 12703 al igual para la clase 1 con un total de 12257. Aunque presenta cierto margen de error, el modelo realiza un buen trabajo.</p>
</section>
<section id="tablas-de-metricas">
<h2><strong>Tablas de Metricas</strong><a class="headerlink" href="#tablas-de-metricas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datametricas</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;K-NN&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Clasificación bayesiana&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Regresión Logística L1&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Regresión Logística L2&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;Random Forest&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;XGBoost&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;SVM&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Precisión&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.852974</span><span class="p">,</span> <span class="mf">0.688863</span><span class="p">,</span> <span class="mf">0.753786</span><span class="p">,</span> <span class="mf">0.753871</span><span class="p">,</span> <span class="mf">0.914397</span><span class="p">,</span> <span class="mf">0.892759</span><span class="p">,</span> <span class="mf">0.866342</span><span class="p">],</span>
    <span class="s2">&quot;Recall&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.778182</span><span class="p">,</span> <span class="mf">0.726106</span><span class="p">,</span> <span class="mf">0.765009</span><span class="p">,</span> <span class="mf">0.76494</span><span class="p">,</span> <span class="mf">0.787856</span><span class="p">,</span> <span class="mf">0.872178</span><span class="p">,</span> <span class="mf">0.840961</span><span class="p">],</span>
    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.813863</span><span class="p">,</span> <span class="mf">0.706994</span><span class="p">,</span> <span class="mf">0.759356</span><span class="p">,</span> <span class="mf">0.759365</span><span class="p">,</span> <span class="mf">0.846423</span><span class="p">,</span> <span class="mf">0.882349</span><span class="p">,</span> <span class="mf">0.853462</span><span class="p">],</span>
    <span class="s2">&quot;AUC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.889425</span><span class="p">,</span> <span class="mf">0.763836</span><span class="p">,</span> <span class="mf">0.795737</span><span class="p">,</span> <span class="mf">0.79575</span><span class="p">,</span> <span class="mf">0.940191</span><span class="p">,</span> <span class="mf">0.950247</span><span class="p">,</span> <span class="mf">0.9142</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">dfmet</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datametricas</span><span class="p">)</span>
<span class="n">dfmet</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Precisión</th>
      <th>Recall</th>
      <th>F1 Score</th>
      <th>AUC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>0.852974</td>
      <td>0.778182</td>
      <td>0.813863</td>
      <td>0.889425</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Clasificación bayesiana</td>
      <td>0.688863</td>
      <td>0.726106</td>
      <td>0.706994</td>
      <td>0.763836</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Logística L1</td>
      <td>0.753786</td>
      <td>0.765009</td>
      <td>0.759356</td>
      <td>0.795737</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Logística L2</td>
      <td>0.753871</td>
      <td>0.764940</td>
      <td>0.759365</td>
      <td>0.795750</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Random Forest</td>
      <td>0.914397</td>
      <td>0.787856</td>
      <td>0.846423</td>
      <td>0.940191</td>
    </tr>
    <tr>
      <th>5</th>
      <td>XGBoost</td>
      <td>0.892759</td>
      <td>0.872178</td>
      <td>0.882349</td>
      <td>0.950247</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SVM</td>
      <td>0.866342</td>
      <td>0.840961</td>
      <td>0.853462</td>
      <td>0.914200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Luego de realizar la tabla anterior, se puede analizar que el modelo XGBoost presenta el AUC más alto, y el modelo de clasificación bayesiana el más bajo. Random Forest y SVM también presentan buen desempeño con AUC altos.</p>
</section>
<section id="curvas-roc">
<h2><strong>Curvas ROC</strong><a class="headerlink" href="#curvas-roc" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>

<span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_knn</span><span class="p">)</span>
<span class="n">fpr_cb</span><span class="p">,</span> <span class="n">tpr_cb</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_cb</span><span class="p">)</span>
<span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">prob_lr</span><span class="p">)</span>
<span class="n">fpr_prob</span><span class="p">,</span> <span class="n">tpr_prob</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">)</span>
<span class="n">fpr_rf</span><span class="p">,</span> <span class="n">tpr_rf</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">probabilities_rf</span><span class="p">)</span>
<span class="n">fpr_y_pred</span><span class="p">,</span> <span class="n">tpr_y_pred</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
<span class="n">fpr_svm</span><span class="p">,</span> <span class="n">tpr_svm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_new_test</span><span class="p">,</span> <span class="n">y_prob_svm</span><span class="p">)</span> 

<span class="n">roc_auc_knn</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">)</span>
<span class="n">roc_auc_cb</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_cb</span><span class="p">,</span> <span class="n">tpr_cb</span><span class="p">)</span>
<span class="n">roc_auc_lr</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">)</span>
<span class="n">roc_auc_prob</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_prob</span><span class="p">,</span> <span class="n">tpr_prob</span><span class="p">)</span>
<span class="n">roc_auc_rf</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_rf</span><span class="p">,</span> <span class="n">tpr_rf</span><span class="p">)</span>
<span class="n">roc_auc_y_pred</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_y_pred</span><span class="p">,</span> <span class="n">tpr_y_pred</span><span class="p">)</span>
<span class="n">roc_auc_svm</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">fpr_svm</span><span class="p">,</span> <span class="n">tpr_svm</span><span class="p">)</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_knn</span><span class="p">,</span> <span class="n">tpr_knn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;KNN (AUC = </span><span class="si">{</span><span class="n">roc_auc_knn</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_cb</span><span class="p">,</span> <span class="n">tpr_cb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Clasificación Bayesiana (AUC = </span><span class="si">{</span><span class="n">roc_auc_cb</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_lr</span><span class="p">,</span> <span class="n">tpr_lr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;L1 (AUC = </span><span class="si">{</span><span class="n">roc_auc_lr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_prob</span><span class="p">,</span> <span class="n">tpr_prob</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;L2 (AUC = </span><span class="si">{</span><span class="n">roc_auc_prob</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_rf</span><span class="p">,</span> <span class="n">tpr_rf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Random Forest (AUC = </span><span class="si">{</span><span class="n">roc_auc_rf</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_y_pred</span><span class="p">,</span> <span class="n">tpr_y_pred</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;XG Boost (AUC = </span><span class="si">{</span><span class="n">roc_auc_y_pred</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr_svm</span><span class="p">,</span> <span class="n">tpr_svm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;SVM (AUC = </span><span class="si">{</span><span class="n">roc_auc_svm</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span> 


<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Configuración del gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de falsos positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de verdaderos positivos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curvas ROC para diferentes modelos&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f5126289960fcb966311e88861808cd64c30c7ed116c0ffedc2cf7cdba1c9c9.png" src="_images/1f5126289960fcb966311e88861808cd64c30c7ed116c0ffedc2cf7cdba1c9c9.png" />
</div>
</div>
</section>
<section id="conclusion">
<h2><strong>Conclusión</strong><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>Tras analizar la tabla de métricas y la curva ROC, se concluye que el modelo más efectivo para este conjunto de datos es XGBoost, con un <strong>AUC = 0.95</strong>, lo que demuestra su excelente capacidad para discriminar entre las clases para este ejercicio. En contraste, el modelo de Clasificación Bayesiana, con el AUC más bajo (0.76), presentó el desempeño menos favorable, lo que sugiere que no es la opción más adecuada para este caso.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Entrega parcial #3</p>
      </div>
    </a>
    <a class="right-next"
       href="segundopunto.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Physical Therapy Dataset: Regresión</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Primer punto: Modelo de Clasificación</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-datos"><strong>Descripción de los datos</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-observaciones"><strong>Número de observaciones</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#media-mediana-minimo-maximo-cuartiles-desviacion-estandar"><strong>Media, mediana, mínimo, máximo, cuartiles, desviación estandar</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes"><strong>Datos Faltantes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas"><strong>Gráficas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-y-multicolinealidad"><strong>Correlación y multicolinealidad</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-multicolinealidad"><strong>Reducción de multicolinealidad</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-filtrados"><strong>Datos filtrados</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>Modelos</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adasyn"><strong>Adasyn</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn"><strong>KNN</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-bayesiana"><strong>Clasificación bayesiana</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica"><strong>Regresión Logística</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#l1"><strong>L1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#l2"><strong>L2</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest"><strong>Random Forest</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost"><strong>XGboost</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm"><strong>SVM</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-metricas"><strong>Tablas de Metricas</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curvas-roc"><strong>Curvas ROC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusión</strong></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gwyneth Blanco & Nicoll Fontalvo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>